{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState } from \"react\"; // let socket; // 소켓\n// 웹소켓 연결\n\nfunction ConnectWS() {\n  _s();\n\n  const [ticker, setTicker] = useState(0);\n\n  const onChangeTicker = event => setTicker(event.target.value); //   if (socket != undefined) {\n  //     socket.close();\n  //   }\n\n\n  return function () {\n    let action = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return (dispatch, getState) => {\n      let socket = new W3CWebSocket(\"wss://api.upbit.com/websocket/v1\");\n      socket.binaryType = \"arraybuffer\"; //socket = new WebSocket(\"wss://api.upbit.com/websocket/v1\");\n      //socket.binaryType = \"arraybuffer\";\n\n      socket.onopen = () => {\n        socket.send(JSON.stringify([{\n          ticket: \"UNIQUE_TICKET\"\n        }, {\n          type: \"ticker\",\n          codes: [\"KRW-BTC\"]\n        }, // \"KRW-BTC\",\"KRW-ETH\" -> parsing\n        {\n          type: \"orderbook\",\n          codes: [\"KRW-BTC\"]\n        }, {\n          type: \"trade\",\n          codes: [\"KRW-BTC\"]\n        }]));\n      };\n\n      socket.onclose = function (e) {\n        socket = undefined;\n      };\n\n      socket.onmessage = e => {\n        var enc = new TextDecoder(\"utf-8\");\n        var arr = new Uint8Array(e.data);\n        var str_d = enc.decode(arr);\n        var d = JSON.parse(str_d);\n        const state = getState();\n\n        if (d.type == \"ticker\") {\n          dispatch({\n            type: SUCCESS,\n            payload: state\n          }); // 현재가 데이터\n          // TOD\n\n          console.log(\"yay\");\n        }\n\n        if (d.type == \"orderbook\") {// 호가 데이터\n          // TODO\n        }\n\n        if (d.type == \"trade\") {// 체결 데이터\n          // TODO\n        }\n      };\n\n      socket.onerror = e => {\n        dispatch({\n          type: Error,\n          payload: e\n        });\n      };\n    };\n  };\n} // 웹소켓 연결 해제\n\n\n_s(ConnectWS, \"hYSOyKwoR4MQ1TxRgQnEQ9myPzU=\");\n\n_c = ConnectWS;\n\nfunction closeWS() {\n  if (socket != undefined) {\n    socket.close();\n    socket = undefined;\n  }\n} // 웹소켓 요청\n\n\nfunction filterRequest(filter) {\n  if (socket == undefined) {\n    alert(\"no connect exists\");\n    return;\n  }\n\n  socket.send(filter);\n} //ConnectWS();\n\n\nfunction sendMessage(_ref) {\n  let {} = _ref;\n  return;\n}\n\nexport default ConnectWS;\n\nvar _c;\n\n$RefreshReg$(_c, \"ConnectWS\");","map":{"version":3,"names":["useState","ConnectWS","ticker","setTicker","onChangeTicker","event","target","value","action","dispatch","getState","socket","W3CWebSocket","binaryType","onopen","send","JSON","stringify","ticket","type","codes","onclose","e","undefined","onmessage","enc","TextDecoder","arr","Uint8Array","data","str_d","decode","d","parse","state","SUCCESS","payload","console","log","onerror","Error","closeWS","close","filterRequest","filter","alert","sendMessage"],"sources":["/Users/ys/Documents/grid-trading/src/connect.js"],"sourcesContent":["import { useState } from \"react\";\n\n// let socket; // 소켓\n\n// 웹소켓 연결\nfunction ConnectWS() {\n  const [ticker, setTicker] = useState(0);\n  const onChangeTicker = (event) => setTicker(event.target.value);\n  //   if (socket != undefined) {\n  //     socket.close();\n  //   }\n\n  return (action = {}) =>\n    (dispatch, getState) => {\n      let socket = new W3CWebSocket(\"wss://api.upbit.com/websocket/v1\");\n      socket.binaryType = \"arraybuffer\";\n\n      //socket = new WebSocket(\"wss://api.upbit.com/websocket/v1\");\n      //socket.binaryType = \"arraybuffer\";\n\n      socket.onopen = () => {\n        socket.send(\n          JSON.stringify([\n            { ticket: \"UNIQUE_TICKET\" },\n            { type: \"ticker\", codes: [\"KRW-BTC\"] }, // \"KRW-BTC\",\"KRW-ETH\" -> parsing\n            { type: \"orderbook\", codes: [\"KRW-BTC\"] },\n            { type: \"trade\", codes: [\"KRW-BTC\"] },\n          ])\n        );\n      };\n      socket.onclose = function (e) {\n        socket = undefined;\n      };\n      socket.onmessage = (e) => {\n        var enc = new TextDecoder(\"utf-8\");\n        var arr = new Uint8Array(e.data);\n        var str_d = enc.decode(arr);\n        var d = JSON.parse(str_d);\n        const state = getState();\n        if (d.type == \"ticker\") {\n          dispatch({ type: SUCCESS, payload: state });\n          // 현재가 데이터\n          // TOD\n          console.log(\"yay\");\n        }\n        if (d.type == \"orderbook\") {\n          // 호가 데이터\n          // TODO\n        }\n        if (d.type == \"trade\") {\n          // 체결 데이터\n          // TODO\n        }\n      };\n      socket.onerror = (e) => {\n        dispatch({ type: Error, payload: e });\n      };\n    };\n}\n// 웹소켓 연결 해제\nfunction closeWS() {\n  if (socket != undefined) {\n    socket.close();\n    socket = undefined;\n  }\n}\n\n// 웹소켓 요청\nfunction filterRequest(filter) {\n  if (socket == undefined) {\n    alert(\"no connect exists\");\n    return;\n  }\n  socket.send(filter);\n}\n\n//ConnectWS();\n\nfunction sendMessage({}) {\n  return;\n}\n\nexport default ConnectWS;\n"],"mappings":";;AAAA,SAASA,QAAT,QAAyB,OAAzB,C,CAEA;AAEA;;AACA,SAASC,SAAT,GAAqB;EAAA;;EACnB,MAAM,CAACC,MAAD,EAASC,SAAT,IAAsBH,QAAQ,CAAC,CAAD,CAApC;;EACA,MAAMI,cAAc,GAAIC,KAAD,IAAWF,SAAS,CAACE,KAAK,CAACC,MAAN,CAAaC,KAAd,CAA3C,CAFmB,CAGnB;EACA;EACA;;;EAEA,OAAO;IAAA,IAACC,MAAD,uEAAU,EAAV;IAAA,OACL,CAACC,QAAD,EAAWC,QAAX,KAAwB;MACtB,IAAIC,MAAM,GAAG,IAAIC,YAAJ,CAAiB,kCAAjB,CAAb;MACAD,MAAM,CAACE,UAAP,GAAoB,aAApB,CAFsB,CAItB;MACA;;MAEAF,MAAM,CAACG,MAAP,GAAgB,MAAM;QACpBH,MAAM,CAACI,IAAP,CACEC,IAAI,CAACC,SAAL,CAAe,CACb;UAAEC,MAAM,EAAE;QAAV,CADa,EAEb;UAAEC,IAAI,EAAE,QAAR;UAAkBC,KAAK,EAAE,CAAC,SAAD;QAAzB,CAFa,EAE2B;QACxC;UAAED,IAAI,EAAE,WAAR;UAAqBC,KAAK,EAAE,CAAC,SAAD;QAA5B,CAHa,EAIb;UAAED,IAAI,EAAE,OAAR;UAAiBC,KAAK,EAAE,CAAC,SAAD;QAAxB,CAJa,CAAf,CADF;MAQD,CATD;;MAUAT,MAAM,CAACU,OAAP,GAAiB,UAAUC,CAAV,EAAa;QAC5BX,MAAM,GAAGY,SAAT;MACD,CAFD;;MAGAZ,MAAM,CAACa,SAAP,GAAoBF,CAAD,IAAO;QACxB,IAAIG,GAAG,GAAG,IAAIC,WAAJ,CAAgB,OAAhB,CAAV;QACA,IAAIC,GAAG,GAAG,IAAIC,UAAJ,CAAeN,CAAC,CAACO,IAAjB,CAAV;QACA,IAAIC,KAAK,GAAGL,GAAG,CAACM,MAAJ,CAAWJ,GAAX,CAAZ;QACA,IAAIK,CAAC,GAAGhB,IAAI,CAACiB,KAAL,CAAWH,KAAX,CAAR;QACA,MAAMI,KAAK,GAAGxB,QAAQ,EAAtB;;QACA,IAAIsB,CAAC,CAACb,IAAF,IAAU,QAAd,EAAwB;UACtBV,QAAQ,CAAC;YAAEU,IAAI,EAAEgB,OAAR;YAAiBC,OAAO,EAAEF;UAA1B,CAAD,CAAR,CADsB,CAEtB;UACA;;UACAG,OAAO,CAACC,GAAR,CAAY,KAAZ;QACD;;QACD,IAAIN,CAAC,CAACb,IAAF,IAAU,WAAd,EAA2B,CACzB;UACA;QACD;;QACD,IAAIa,CAAC,CAACb,IAAF,IAAU,OAAd,EAAuB,CACrB;UACA;QACD;MACF,CApBD;;MAqBAR,MAAM,CAAC4B,OAAP,GAAkBjB,CAAD,IAAO;QACtBb,QAAQ,CAAC;UAAEU,IAAI,EAAEqB,KAAR;UAAeJ,OAAO,EAAEd;QAAxB,CAAD,CAAR;MACD,CAFD;IAGD,CA7CI;EAAA,CAAP;AA8CD,C,CACD;;;GAtDSrB,S;;KAAAA,S;;AAuDT,SAASwC,OAAT,GAAmB;EACjB,IAAI9B,MAAM,IAAIY,SAAd,EAAyB;IACvBZ,MAAM,CAAC+B,KAAP;IACA/B,MAAM,GAAGY,SAAT;EACD;AACF,C,CAED;;;AACA,SAASoB,aAAT,CAAuBC,MAAvB,EAA+B;EAC7B,IAAIjC,MAAM,IAAIY,SAAd,EAAyB;IACvBsB,KAAK,CAAC,mBAAD,CAAL;IACA;EACD;;EACDlC,MAAM,CAACI,IAAP,CAAY6B,MAAZ;AACD,C,CAED;;;AAEA,SAASE,WAAT,OAAyB;EAAA,IAAJ,EAAI;EACvB;AACD;;AAED,eAAe7C,SAAf"},"metadata":{},"sourceType":"module"}